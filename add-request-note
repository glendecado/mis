<x-modal name="add-request-modal">

    <h1 class="text-[#2e5e91] text-[28px] text-center font-medium">Service Request Form</h1>

    <div class="y p-2 mt-4"
        x-data="{
            category : @entangle('category_'),
            concerns : @entangle('concerns'),
            message: '',
            showLocationEdit: false, // Variable to control showing location edit form
            college: @entangle('college'),
            building: @entangle('building'),
            room: @entangle('room')
        }">
        @include('components.requests.confirm-location')

        <h1 class="mb-2">Category</h1>
        <div class="border rounded-md p-4 mb-2">
            <div class="y">
                <livewire:categories wire:model="category_" />
                @error('concerns')
                <span class="text-red-500"> {{$message}}</span>
                @enderror
            </div>
        </div>

        <h1 class="mb-2">Concerns</h1>
        <textarea
            name="" id=""
            x-model="concerns"
            class="input"
            placeholder="Write your concerns here...">
        </textarea>

        <!-- Location Section -->
        <div class="y mb-2">
            <div class="flex flex-row justify-between items-center mb-2">
                <h1>Location</h1>
                <button @click="showLocationEdit = !showLocationEdit">
                    <x-icons.edit class="size-6"/>
                </button>
            </div>
            <div class="border py-2 px-4 rounded-md flex justify-between">
                <div>College: <span x-text="college" class="font-bold"></span></div>
                <div>Building: <span x-text="building" class="font-bold"></span></div>
                <div>Room: <span x-text="room" class="font-bold"></span></div>
            </div>
        </div>

        <!-- Edit Location Form -->
        <div x-show="showLocationEdit" x-transition class="y mb-2">
            <div class="md:x y gap-2 mb-2">
                <div>
                    <label for="college" class="label">College</label>
                    <input x-model="college" type="text" class="input w-full uppercase" />
                </div>
                <div>
                    <label for="building" class="label">Building</label>
                    <input x-model="building" type="text" class="input w-full uppercase" />
                </div>
                <div>
                    <label for="room" class="label">Room</label>
                    <input x-model="room" type="text" class="input w-full uppercase" />
                </div>
            </div>

            <!-- Disable button if any of the fields are empty -->
            <button
                class="button mt-4" style="color: white; background-color: #2e5e91; "
                :disabled="!college || !building || !room"
                @click="$wire.confirmLocation(); showLocationEdit = false">
                Update Location
            </button>
        </div>

        <button
            wire:loading.attr="disabled"
            wire:click.prevent="addRequest"
            class="button mt-4" style="color: white; background-color: #2e5e91; ">
            Submit
        </button>

    </div>

</x-modal>

<!-- Location Edit Modal (No longer needed but kept for context) -->
<x-modal name="edit-loc">
    <div class="y mb-2" x-data="{
        college: @entangle('college'),
        building: @entangle('building'),
        room: @entangle('room')
    }">
        <div class="md:x y gap-2 mb-2">
            <div>
                <label for="college" class="label">College</label>
                <input x-model="college" type="text" class="input w-full uppercase" />
            </div>
            <div>
                <label wire:model="building" for="building" class="label">Building</label>
                <input x-model="building" type="text" class="input w-full uppercase" />
            </div>
            <div>
                <label wire:model="room" for="room" class="label">Room</label>
                <input x-model="room" type="text" class="input w-full uppercase" />
            </div>
        </div>

        <!-- Disable button if any of the fields are empty -->
        <button
            class="button mt-4" style="color: white; background-color: #2e5e91; "
            :disabled="!college || !building || !room"
            @click="$wire.confirmLocation(); $dispatch('close-modal', 'edit-loc')">
            Update Location
        </button>
    </div>
</x-modal>
